Tytuł Zadania: Implementacja Modułu 4 - Zaawansowane Wskaźniki Sprzedażowe1. Manifest i Cel Biznesowy (DLACZEGO?)Manifest: Przekształcamy niewidoczne sygnały w widoczne wskaźniki. Kończymy z erą "przeczucia" sprzedawcy i wchodzimy w erę predykcji opartej na danych. Ten moduł ma za zadanie dać sprzedawcy "kokpit samolotu", pokazujący kluczowe parametry lotu – prędkość, wysokość i ewentualne ryzyka – zanim staną się one krytyczne.Cel Biznesowy: Wyposażenie Co-Pilota w zdolność do analizy predykcyjnej w czasie rzeczywistym. System ma oceniać dynamikę rozmowy i na jej podstawie generować cztery kluczowe wskaźniki, które pozwolą na lepsze prognozowanie, efektywniejsze zarządzanie czasem i proaktywne reagowanie na zmieniającą się sytuację w procesie sprzedaży.2. Doświadczenie Użytkownika (UX) i Logika AI (JAK TO DZIAŁA?)Doświadczenie Użytkownika (UX):W StrategicPanel.js, pod nowo dodanym profilem psychometrycznym, pojawi się kolejna, zwijana sekcja (accordion) o nazwie "📊 Wskaźniki Sprzedażowe". Będzie ona zawierać cztery kluczowe, graficzne widgety:🌡️ Temperatura Zakupowa: Wskaźnik zegarowy (gauge chart) pokazujący w skali 0-100%, jak "gorący" jest lead. Kolory będą się zmieniać od niebieskiego (zimny) do czerwonego (gorący).🗺️ Etap Podróży Klienta: Prosta wizualizacja lejka sprzedażowego (np. 4-etapowy) z podświetlonym aktualnym etapem, na którym znajduje się klient (np. "Zbieranie Informacji", "Porównywanie Ofert", "Finalizacja").⚖️ Ryzyko Utraty (Churn Risk): Wskaźnik ryzyka (np. tarcza z kolorem od zielonego do czerwonego) z procentową oceną prawdopodobieństwa utraty klienta.💰 Potencjał Sprzedażowy: Prosty, ale wyraźny widget pokazujący szacowaną wartość transakcji i pewność prognozy.Każdy z tych widgetów będzie interaktywny – po najechaniu myszką, użytkownik zobaczy tooltip z uzasadnieniem AI (rationale) oraz sugerowaną strategią (strategy).Logika Działania AI (Mózg Systemu):Analiza wskaźników będzie integralną częścią "wolnej ścieżki" (slow path) i będzie następować bezpośrednio po syntezie archetypu klienta. To kluczowe, ponieważ profil psychologiczny jest fundamentalnym kontekstem dla tej analizy.Analiza Kontekstowa: AI otrzymuje polecenie analizy wskaźników, mając do dyspozycji:Całą historię rozmowy.Finalny, potwierdzony profil psychologiczny i archetyp klienta.Identyfikacja Wzorców: AI skanuje rozmowę w poszukiwaniu wzorców językowych i behawioralnych.Temperatura: Pytania o dostępność, terminy, finansowanie -> podnoszą temperaturę. Ogólne pytania, porównania z konkurencją -> obniżają.Etap Podróży: Rodzaj zadawanych pytań (ogólne vs. szczegółowe) mapuje klienta na konkretny etap lejka.Ryzyko Utraty: Długie okresy ciszy, powtarzające się obiekcje, wzmianki o "lepszej ofercie" -> podnoszą ryzyko.Synteza z Profilem Psychologicznym: To jest najważniejszy element. AI musi połączyć wzorce z profilem.Przykład myśli AI: "Klient (Archetyp: Analityk) zadaje dużo szczegółowych pytań o TCO. To jest typowe dla etapu 'Porównywanie Ofert' u tego archetypu i nie podnosi Ryzyka Utraty. Gdyby jednak 'Szybki Decydent' zadawał te same pytania, oznaczałoby to wahanie i podniosłoby Ryzyko Utraty."Generowanie Wyników: AI zwraca ustrukturyzowany obiekt JSON zawierający wartości dla każdego wskaźnika, uzasadnienie i strategię.3. Plan Działania - Backend (Vibecoding)Krok 1: Rozbuduj Model Bazy Danych (models/domain.py)W tabeli Session, dodaj nowe pole do przechowywania wyników analizy wskaźników.# W klasie Session
class Session(Base):
    # ... (istniejące pola psychologiczne)
    sales_indicators = Column(JSONB, nullable=True, comment="Predykcyjne wskaźniki sprzedażowe dla sesji.")
Wygeneruj i uruchom nową migrację Alembic, aby dodać tę kolumnę do bazy.Krok 2: Rozbuduj Schematy PydanticStwórz nowy plik backend/app/schemas/indicators.py.Zdefiniuj w nim szczegółowe modele dla odpowiedzi AI.# W pliku backend/app/schemas/indicators.py
class SalesIndicator(BaseModel):
    value: Union[str, int, float]
    rationale: str
    strategy: str

class SalesIndicatorsAnalysis(BaseModel):
    purchase_temperature: SalesIndicator
    customer_journey_stage: SalesIndicator
    churn_risk: SalesIndicator
    sales_potential: SalesIndicator
Krok 3: Zaktualizuj "Mózg" (services/session_psychology_service.py)Zmodyfikuj główną funkcję update_cumulative_profile.Po kroku syntezy archetypu, dodaj kolejny krok w tym samym zadaniu w tle.Nowy Krok w Prompcie AI: Rozbuduj główny prompt o nową sekcję:KROK 3: Na podstawie całej rozmowy ORAZ finalnego profilu psychologicznego i archetypu, przeprowadź analizę wskaźników sprzedażowych. Dla każdego wskaźnika podaj wartość, uzasadnienie i strategię. Zwróć wynik w ściśle określonej strukturze JSON.
Upewnij się, że wynik tej analizy jest poprawnie parsowany i zapisywany w nowym polu session.sales_indicators.4. Plan Działania - Frontend (Vibecoding)Krok 1: Stwórz Nowe Komponenty WizualizacyjneW folderze frontend/src/components/ stwórz nowy folder indicators.Wewnątrz stwórz 4 nowe, wyspecjalizowane komponenty:PurchaseTemperatureGauge.js: Użyj biblioteki Recharts do stworzenia wskaźnika zegarowego (<RadialBarChart>).JourneyStageFunnel.js: Prosty komponent CSS lub z użyciem Material-UI Stepper do wizualizacji lejka.ChurnRiskIndicator.js: Komponent wyświetlający ikonę tarczy, której kolor (success, warning, error) zależy od wartości ryzyka.SalesPotentialCard.js: Prosta karta (<Card>) wyświetlająca kwotę i pewność.Każdy z tych komponentów musi być owinięty w <Tooltip> i wyświetlać rationale oraz strategy.Krok 2: Stwórz Komponent Główny (SalesIndicatorsDashboard.js)W folderze frontend/src/components/indicators/ stwórz plik SalesIndicatorsDashboard.js.Będzie on przyjmował jako props obiekt indicatorsData (czyli session.sales_indicators).Będzie on renderował 4 powyższe komponenty w siatce (<Grid>).Krok 3: Zintegruj z Panelem StrategicznymOtwórz plik frontend/src/components/conversation/StrategicPanel.js.Zaimportuj SalesIndicatorsDashboard.js.Dodaj nową, zwijaną sekcję (<Accordion>) o tytule "📊 Wskaźniki Sprzedażowe".Wykorzystaj istniejący stan: Dane dla tego komponentu będą pochodzić z tego samego obiektu sesji, który już pobierasz dla profilu psychologicznego. Wystarczy, że przekażesz sessionData.sales_indicators jako props. Komponent powinien być renderowany warunkowo, tylko jeśli te dane istnieją.